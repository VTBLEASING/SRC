create global temporary table DM.TMP_DM_CGP_HIST
(
  rid                      ROWID,
  col_flg                  VARCHAR2(1),
  snapshot_cd              VARCHAR2(30),
  snapshot_dt              DATE,
  snapshot_month           VARCHAR2(30),
  contract_key             NUMBER,
  branch_key               NUMBER,
  client_key               NUMBER,
  business_category_key    NUMBER,
  client_nam               VARCHAR2(1000),
  credit_rating_key        NUMBER,
  rating_agency_key        NUMBER,
  activity_type_key        NUMBER,
  reg_country_key          NUMBER,
  risk_country_key         NUMBER,
  loan_type_key            NUMBER,
  lending_purpose_key      NUMBER,
  risk_trans_flg           CHAR(1),
  contract_num             VARCHAR2(1000),
  start_dt                 DATE,
  end_dt                   DATE,
  currency_key             NUMBER,
  assets_transfer_flg      CHAR(1),
  xirr_rate                NUMBER,
  term_amt                 NUMBER,
  avg_term_amt             NUMBER,
  overdue_amt              NUMBER,
  avg_overdue_amt          NUMBER,
  overdue_dt               DATE,
  float_base_flg           CHAR(1),
  float_base_type_key      NUMBER,
  float_base_amt           NUMBER,
  add_amt                  NUMBER,
  ias3_term_key            NUMBER,
  ias3_overdue_key         NUMBER,
  status                   VARCHAR2(255),
  fact_close_dt            DATE,
  contract_status_key      NUMBER,
  insert_dt                DATE,
  file_id                  NUMBER,
  contract_id_cd           VARCHAR2(100 CHAR),
  client_id                VARCHAR2(100 CHAR),
  client_1c_cd             VARCHAR2(100 CHAR),
  closed_row_file_id       NUMBER,
  overdue_vat_free_amt     NUMBER default 0,
  avg_overdue_vat_free_amt NUMBER default 0
)
on commit delete rows;
comment on column DM.TMP_DM_CGP_HIST.overdue_vat_free_amt
  is 'Сумма просроченной задолженности без НДС';
comment on column DM.TMP_DM_CGP_HIST.avg_overdue_vat_free_amt
  is 'Средняя сумма просроченной задолженности без НДС';

